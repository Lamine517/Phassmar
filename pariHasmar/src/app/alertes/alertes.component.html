<div class="container-fluid">

  <div class="col">

    <!-- Ajouter une nouvelle alerte -->
    <!-- Boîte de dialogue -->
    <!-- Boîte de dialogue -->
    <ng-template #modalData let-modal>
      <!-- <div class="modal fade" id="ajouterAlerte" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> -->
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Ajouter une Nouvelle Alerte</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"
              (click)="modal.dismiss('Cross click')">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <div class="row">
                <div class="col">
                  <label>Service</label>
                  <app-list-item-service></app-list-item-service>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6">
                  <label>Intitule</label>
                  <input type="text" class="form-control" formControlName="intitule" id="intitule">
                </div>
                <div class="col-sm-6">
                  <label>Niveau</label>
                  <select name="niveau" id="niveau" formControlName="niveau" class="form-control">
                    <option value="critique">Critique</option>
                    <option value="majeur">Majeur</option>
                    <option value="mineur">Mineur</option>
                    <option value="urgent">Urgent</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <div class="col-sm-6">
                  <label>Description</label>
                  <!-- <input type="text" class="form-control" formControlName="description" id="description"> -->
                  <textarea class="form-control" formControlName="description" id="description" cols="30"
                    rows="10"></textarea>
                </div>
                <div class="col-sm-6">
                  <label>fichier</label>
                  <input type="file" class="form-control " accept="image/*" formControlName="fichier" id="fichier"
                    (change)="uploadImage($event)">
                  <!-- <input type="file" class="form-control"  accept="image/*" formControlName="fichier" id="fichier" > -->
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <div class="col-sm-6">
                  <label>latitude</label>
                  <input type="text" class="form-control" formControlName="latitude" id="latitude">
                </div>
                <div class="col-sm-6">
                  <label>longitude</label>
                  <input type="text" class="form-control" formControlName="longitude" id="longitude">
                </div>
              </div>
            </div>

            <br>
            <h6>Destinataire (s)</h6>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input" formControlName="destinataire"
                id="destinataire" value="Ministere de l'interieur">
              <label for="flexSwitchCheckDefault" class="form-check-label">Ministere de l'interieur</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input" formControlName="destinataire"
                id="destinataire" value="Police Nationale">
              <label for="flexSwitchCheckDefault" class="form-check-label">Police Nationale</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="destinataire[]" id="destinataire[]" value="Direction des Douanes">
              <label for="flexSwitchCheckDefault" class="form-check-label">Direction des Douanes</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="destinataire[]" id="destinataire[]" value="Gendarmerie Nationale">
              <label for="flexSwitchCheckDefault" class="form-check-label">Gendarmerie Nationale </label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="destinataire[]" id="destinataire[]" value="Port Autonome de Dakar">
              <label for="flexSwitchCheckDefault" class="form-check-label">Port Autonome de Dakar </label>
            </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"
              (click)="modal.close('Save click')">Annuler</button>
            <button type="button" class="btn btn-primary" (click)="ajouterAlerte()">Enregistrer</button>
          </div>
        </div>
        <!-- </div> -->
      </div>

      <!--//fin  -->

      <!-- </div> -->
    </ng-template>
    <!--  -->
    <div class="row" style="display: flex; flex-direction: row;">
      <div class="col-md-6">
        <div class="col">
          <input class="form-control " type="search" #searchInput (keyup)="search(searchInput.value)" name=""
            placeholder="rechercher ici" id="">
        </div>
      </div>

      <div class="col-md-6">
        <!-- pour les reseaux sociaux -->
        <a routerLink="/alertes"><i class="fa fa-telegram mx-2 mes_icons"></i></a>
        <a routerLink="/alertes"><i class="fa fa-envelope mx-2 mes_icons"></i></a>
        <a routerLink="/alertes"><i class="fa fa-comment mx-2 mes_icons"></i></a>
        <a routerLink="/alertes"><i class="fa fa-whatsapp mx-auto mes_icons"></i></a>
        <!-- pour les actions -->
        <div style="float: right;">
          <button type="submit" class="btn btn-danger supprimer"> <i class="fa fa-trash"></i>
            Supprimer</button>
          <button type="submit" class="btn btn-primary mx-3"> <i class="fa fa-share-square"></i>
            Exporter</button>
          <button class="btn btn-primary" data-toggle="modal" data-target="#ajouterAlerte"
            (click)="triggerModal(modalData)"> <i class="fa fa-plus"></i> Nouvelle Alerte</button>
        </div>
      </div>

    </div><br>

    <div class="col pt-5">
      <table class="table table-hover" style="height: 40vh; overflow: auto;">
        <caption>
          <span class="text-primary ">LISTE DE TOUTES LES ALERTES ( {{Allalertes.length}} )</span>
        </caption>
        <thead>
          <tr>
            <th scope="col"></th>
            <th scope="col">ID</th>
            <th scope="col">Intitule d'alerte</th>
            <th scope="col">Niveau d'alerte</th>
            <th scope="col">Date</th>
            <th scope="col">Créée par</th>
            <th scope="col">Destinataire (s)</th>
            <th scope="col">Progression</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let alerte of Allalertes">
            <td><input type="checkbox" name="" id="" class="form-check-input"></td>
            <td>{{ alerte.id}}</td>
            <td>{{ alerte.intitule}}</td>
            <td>
              <button type="button" [ngClass]="{
              'btn btn-':true,
              'btn btn-primary': alerte.niveau === 'critique',
              'btn btn-danger': alerte.niveau === 'urgent',
              'btn btn-dark': alerte.niveau === 'mineur',
              'btn btn-warning': alerte.niveau === 'majeur'
            }">
                {{ alerte.niveau}} </button>
            </td>
            <td>{{ alerte.created_at | date: 'shortDate'}}</td>
            <td> {{alerte.libelle_service}}</td>
            <td>{{ alerte.destinataire}}</td>
            <td><label for="" style="font-size: smaller;">Accuse de reception : <b>1/2</b></label><br>
              <div class="progress">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 50%" aria-valuemin="0"
                  aria-valuemax="60">

                </div>
              </div>
            </td>
            <td>
              <button type="button" class="btn btn-primary"
                (click)="triggerModal(modalDataView); infosSupplementaires(alerte.id) "><i
                  class="fa fa-eye"></i></button>
              <button type="button" class="btn btn-warning mx-3" data-toggle="modal" data-target="#modifierAlerte"
                (click)="triggerModal(modalDataUpdate) ; showUpdateModel(alerte.id)"><i class="fa fa-edit"></i></button>
              <button type="button" class="btn btn-danger" (click)="delete(alerte.id)"><i
                  class="fa fa-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>


    <!-- Ajouter une nouvelle alerte -->
    <!-- Boîte de dialogue -->
    <ng-template #modalDataUpdate let-modal>
      <!-- <div class="modal fade" id="modifierAlerte" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> -->
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Modifier une Alerte</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"
              (click)="modal.dismiss('Cross click')">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">

            <div class="form-group">
              <div class="row">
                <div class="col">
                  <label>Service</label>
                  <app-list-item-service></app-list-item-service>
                </div>
              </div>
              <div class="row">
                <div class="col-sm-6">
                  <label>Intiule</label>
                  <input type="text" class="form-control" formControlName="updateIntitule" id="updateIntitule">
                </div>
                <div class="col-sm-6">
                  <label>Niveau</label>
                  <select name="niveau" id="updateNiveau" formControlName="updateNiveau" class="form-control">
                    <option value="critique">Critique</option>
                    <option value="majeur">Majeur</option>
                    <option value="mineur">Mineur</option>
                    <option value="urgent">Urgent</option>
                  </select>
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <div class="col-sm-6">
                  <label>Description</label>
                  <input type="text" class="form-control" formControlName="updateDescription" id="updateDescription">
                </div>
                <div class="col-sm-6">
                  <label>fichier</label>
                  <input type="file" class="form-control" formControlName="updateFichier" id="updateFichier">
                </div>
              </div>
            </div>

            <div class="form-group">
              <div class="row">
                <div class="col-sm-6">
                  <label>latitude</label>
                  <input type="text" class="form-control" formControlName="updateLatitude" id="updateLatitude">
                </div>
                <div class="col-sm-6">
                  <label>longitude</label>
                  <input type="text" class="form-control" formControlName="updateLongitude" id="updateLongitude">
                </div>
              </div>
            </div>
            <br>
            <h6>Destinataire (s)</h6>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="updateDestinataire[]" id="updateDestinataire[]">
              <label for="flexSwitchCheckDefault" class="form-check-label">Ministere de l'interieur</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="updateDestinataire[]" id="updateDestinataire[]">
              <label for="flexSwitchCheckDefault" class="form-check-label">Police Nationale</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="updateDestinataire[]" id="updateDestinataire[]">
              <label for="flexSwitchCheckDefault" class="form-check-label">Direction des Douanes</label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="updateDestinataire[]" id="updateDestinataire[]">
              <label for="flexSwitchCheckDefault" class="form-check-label">Gendarmerie Nationale </label>
            </div>
            <div class="form-check form-switch">
              <input type="checkbox" id="flexSwitchCheckDefault" class="form-check-input"
                formControlName="updateDestinataire[]" id="updateDestinataire[]">
              <label for="flexSwitchCheckDefault" class="form-check-label">Port Autonome de Dakar </label>
            </div>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"
              (click)="modal.dismiss('Cross click')">Annuler</button>
            <button type="button" class="btn btn-primary" (click)="update(id)">Mettre a jour</button>
          </div>
        </div>
        <!-- </div> -->
      </div>
    </ng-template>

    <!--//fin  -->

    <!-- *************************************************Voir les alertes ****************************************************-->
    <ng-template #modalDataView let-modal>
      <!-- <div class="modal fade" id="modifierAlerte" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> -->
      <div class="modal-dialog-xl" role="document" style="width:1250px;">
        <div class="modal-content">
          <div class="modal-header bg-dark">
            <h5 class="modal-title text-white text-center" id="exampleModalLabel">INFORMATIONS SUPPLEMENTAIRES</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"
              (click)="modal.dismiss('Cross click')">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>

          <div class="modal-body">
            <div class="row">
              <div class="col-6">
                <table>
                  <tr>
                    <th scope="col">Intitule alerte : </th>
                    <input type="text" class="form-control infosSupplementaires" formControlName="infosIntitule"
                      id="infosIntitule" readonly="true">
                  </tr>
                  <tr>
                    <th scope="col">Niveau d'alerte : </th>
                    <input type="text" class="form-control infosSupplementaires" formControlName="infosNiveau"
                      id="infosNiveau" readonly="true">
                  </tr>
                  <tr>
                    <th scope="col">Creation : </th>
                    <input type="text" class="form-control infosSupplementaires" formControlName="infosCreated"
                      id="infosCreated" readonly="true">
                  </tr>
                  <tr>
                    <th scope="col">Partage : </th>

                    <input type="text" class="form-control infosSupplementaires" formControlName="infosService"
                      id="infosService" readonly="true">
                  </tr>
                  <tr>
                    <th scope="col">Progression : </th>
                    <div class="progress">
                      <div class="progress-bar bg-warning" role="progressbar" style="width: 50%" aria-valuemin="0"
                        aria-valuemax="60">

                      </div>
                    </div>
                  </tr>

                  <tr>
                    <th scope="col">Description : </th>
                    <textarea rows="10" cols="50" class="form-control infosSupplementaires" id="infosDescription"
                      readonly="true" formControlName="infosDescription"></textarea>
                    <!-- <input type="text" class="form-control infosSupplementaires" formControlName="infosDescription" -->
                    <!-- id="infosDescription" readonly="true"> -->

                  </tr>
                  <tr>
                    <th scope="col">Latitude : </th>
                    <td><input type="text" class="form-control infosSupplementaires" formControlName="infosLatitude"
                        id="infosLatitude" readonly="true"></td>
                  </tr>
                  <tr>
                    <th scope="col">Longitude : </th>
                    <td><input type="text" class="form-control infosSupplementaires" formControlName="infosLongitude"
                        id="infosLongitude" readonly="true"></td>
                  </tr>
                </table>
              </div>


              <div class="col-sm-6">
                <!-- <div class="row">

                    <label for="">Destinataire(s) :</label>
                    <p>Ministere de l'interieur</p>
                    <p>Direction des Douanes</p>
                 </div> -->
                <table>
                  <tr>
                    <th scope="col">Destinataire(s) </th>
                    <td><input type="text" class="form-control infosSupplementaires" formControlName="infosDestinataire"
                        id="infosDestinataire" readonly="true"></td>

                  </tr>
                  <tr>
                    <th scope="col">Fichier(s) </th>
                    <td><input type="text" class="form-control infosSupplementaires" formControlName=" infosIntitule"
                        id="infosIntitule" readonly="true"> </td>

                  </tr>
                  <tr>
                    <th scope="col">Notifications </th>
                    <td><input type="text" class="form-control infosSupplementaires" formControlName=" infosIntitule"
                        id="infosIntitule" readonly="true"> </td>
                  </tr>

                </table>
                <h6>Carte</h6>
                <div class="row" style="height:350px; width:100%;background-color:#ccc">
                  <div class="mapouter">
                    <div class="gmap_canvas"><iframe width="100%" height="350px" id="gmap_canvas"
                        src="https://maps.google.com/maps?q=isep%20diamniadio&t=&z=13&ie=UTF8&iwloc=&output=embed"
                        frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe><a
                        href="https://123movies-to.org">123movies</a><br>
                      <style>
                        .mapouter {
                          position: relative;
                          text-align: right;
                          height: 350px;
                          width: 100%;
                        }
                      </style><a href="https://www.embedgooglemap.net">embedded map</a>
                      <style>
                        .gmap_canvas {
                          overflow: hidden;
                          background: none !important;
                          height: 350px;
                          width: 100%;
                        }
                      </style>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal"
              (click)="modal.dismiss('Cross click')">Annuler</button>
            <button type="button" class="btn btn-primary" (click)="update(id)">Mettre a jour</button>
          </div>
        </div>
        <!-- </div> -->
      </div>
    </ng-template>

  </div>